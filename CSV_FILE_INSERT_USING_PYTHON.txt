
---connecting postgres to python
import pandas as pd
from sqlalchemy import create_engine
conn_string= 'postgresql://postgres:pass@localhost/PAINTING'
db = create_engine(conn_string)
conn = db.connect()


--insert single csv table into postgres 

df =pd.read_csv('S:/DATA_ANALYST/SQL/PAINTING/artist.csv')
df.to_sql('artist',con=conn,if_exists='replace',index=False) 

----insert multiple csv table into postgres
files= ['canvas_size','image_link','museum','museum_hours','product_size','subject','work']

for file in files:
   df =pd.read_csv(f'S:/DATA_ANALYST/SQL/PAINTING/{file}.csv')
   df.to_sql(file,con=conn,if_exists='replace',index=False)